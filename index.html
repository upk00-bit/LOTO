<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Lô tô chuẩn</title>

<style>
body {
  font-family: Arial;
  background: #f4f4f4;
  text-align: center;
}

.boards {
  display: grid;
  grid-template-columns: repeat(4, auto);
  gap: 20px;
  justify-content: center;
}

.board {
  background: #fff;
  padding: 5px;
  border: 4px solid;
}

table {
  border-collapse: collapse;
}

td {
  width: 38px;
  height: 38px;
  border: 1px solid #333;
  font-weight: bold;
  cursor: pointer;
}

td.empty {
  background: #e5e5e5;
  cursor: default;
}

td.marked {
  background: #ffeb3b;
}
</style>
</head>

<body>

<h2>MỜI CHỌN VÉ</h2>
<div class="boards" id="boards"></div>

<script>
const COLORS = [
  "#ef4444","#f97316","#eab308","#22c55e","#14b8a6",
  "#3b82f6","#6366f1","#8b5cf6","#ec4899","#f43f5e",
  "#10b981","#0ea5e9","#a855f7","#84cc16","#f59e0b",
  "#dc2626","#16a34a","#9333ea","#0ea5e9","#64748b"
];

const COL_RANGES = [
  [1,9],[10,19],[20,29],[30,39],[40,49],
  [50,59],[60,69],[70,79],[80,90]
];

function shuffle(arr) {
  return arr.sort(() => Math.random() - 0.5);
}

/* ================= CORE LOGIC ================= */
function generateTicket() {
  // 1️⃣ Khởi tạo bảng rỗng
  const board = Array.from({ length: 9 }, () => Array(9).fill(null));

  // 2️⃣ Mỗi hàng chọn đúng 5 cột
  const rowCols = [];
  for (let r = 0; r < 9; r++) {
    rowCols[r] = shuffle([0,1,2,3,4,5,6,7,8]).slice(0,5);
  }

  // 3️⃣ Đếm số ô mỗi cột
  const colCounts = Array(9).fill(0);
  rowCols.forEach(cols => cols.forEach(c => colCounts[c]++));

  // ❗ đảm bảo mỗi cột ≤ 5
  if (Math.max(...colCounts) > 5) return generateTicket();

  // 4️⃣ Tạo pool số cho từng cột
  const colPools = COL_RANGES.map(([min,max],c)=>{
    const nums = [];
    while (nums.length < colCounts[c]) {
      const n = Math.floor(Math.random()*(max-min+1))+min;
      if (!nums.includes(n)) nums.push(n);
    }
    return nums.sort((a,b)=>a-b);
  });

  // 5️⃣ Gán số vào đúng vị trí
  for (let r = 0; r < 9; r++) {
    rowCols[r].forEach(c => {
      board[r][c] = colPools[c].pop();
    });
  }

  return board;
}

/* ================= RENDER ================= */
const boardsDiv = document.getElementById("boards");

for (let i = 0; i < 20; i++) {
  const ticket = generateTicket();
  const wrap = document.createElement("div");
  wrap.className = "board";
  wrap.style.borderColor = COLORS[i];

  const table = document.createElement("table");

  ticket.forEach(row=>{
    const tr = document.createElement("tr");
    row.forEach(cell=>{
      const td = document.createElement("td");
      if (cell === null) {
        td.className = "empty";
      } else {
        td.textContent = cell;
        td.onclick = () => td.classList.toggle("marked");
      }
      tr.appendChild(td);
    });
    table.appendChild(tr);
  });

  wrap.appendChild(table);
  boardsDiv.appendChild(wrap);
}
</script>

</body>
</html>
