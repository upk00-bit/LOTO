<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Lô Tô 9x9</title>

<style>
body {
  font-family: Arial;
  text-align: center;
}

table {
  border-collapse: collapse;
  margin: 15px auto;
  border: 5px solid black;
}

td {
  width: 50px;
  height: 50px;
  border: 2px solid black;
  text-align: center;
  font-weight: bold;
  cursor: pointer;
}

.marked {
  background: #ffeb3b;
}

select {
  font-size: 16px;
  padding: 6px;
}
</style>
</head>

<body>

<h2>Chọn tờ lô tô</h2>
<select id="boardSelect"></select>

<table id="board"></table>

<script>
const TOTAL = 20;
const STORAGE_KEY = "LotoBoardsV1";

const colors = [
  "#f44336","#e91e63","#9c27b0","#3f51b5","#2196f3",
  "#009688","#4caf50","#8bc34a","#ff9800","#ff5722",
  "#795548","#607d8b","#673ab7","#00bcd4","#cddc39",
  "#ffc107","#ff7043","#81c784","#64b5f6","#ba68c8"
];

function rand(min, max) {
  return Math.floor(Math.random() * (max - min + 1)) + min;
}

/* TẠO 1 TỜ HỢP LỆ */
function generateBoard() {
  let board = [];
  let used = new Set();

  for (let r = 0; r < 9; r++) {
    let row = Array(9).fill("");
    let cols = [];

    while (cols.length < 5) {
      let c = rand(0, 8);
      if (!cols.includes(c)) cols.push(c);
    }

    cols.forEach(c => {
      let min = c * 10 + 1;
      let max = (c === 8) ? 90 : c * 10 + 9;
      let num;
      do {
        num = rand(min, max);
      } while (used.has(num));
      used.add(num);
      row[c] = num;
    });

    board.push(row);
  }
  return board;
}

function sameBoard(a, b) {
  return JSON.stringify(a) === JSON.stringify(b);
}

/* LẤY HOẶC TẠO 20 TỜ */
function loadBoards() {
  let data = localStorage.getItem(STORAGE_KEY);
  if (data) return JSON.parse(data);

  let boards = {};
  for (let i = 1; i <= TOTAL; i++) {
    let b;
    do {
      b = generateBoard();
    } while (Object.values(boards).some(x => sameBoard(x, b)));
    boards[i] = b;
  }

  localStorage.setItem(STORAGE_KEY, JSON.stringify(boards));
  return boards;
}

const boards = loadBoards();

/* DROPDOWN */
const select = document.getElementById("boardSelect");
for (let i = 1; i <= TOTAL; i++) {
  let opt = document.createElement("option");
  opt.value = i;
  opt.text = "Tờ " + i;
  select.appendChild(opt);
}

/* HIỂN THỊ */
function loadBoard(id) {
  const table = document.getElementById("board");
  table.innerHTML = "";
  table.style.borderColor = colors[id - 1];

  boards[id].forEach(row => {
    let tr = document.createElement("tr");
    row.forEach(cell => {
      let td = document.createElement("td");
      td.textContent = cell;
      td.style.borderColor = colors[id - 1];
      td.onclick = () => td.classList.toggle("marked");
      tr.appendChild(td);
    });
    table.appendChild(tr);
  });
}

select.onchange = () => loadBoard(select.value);
loadBoard(1);
</script>

</body>
</html>
